{"version":3,"file":"index.js","sources":["../src/util/index.js","../src/log/base.js","../src/queue/base.js","../src/queue/wx.js","../src/log/wx.js","../src/index.js"],"sourcesContent":["/**\n * 生成用户唯一标识码\n */\nfunction generateUUID() {\n    let uuid = '',\n      d = new Date().getTime()\n  \n    uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n      let r = (d + Math.random() * 16) % 16 | 0;\n      d = Math.floor(d / 16);\n      return (c == 'x' ? r : (r & 0x3 | 0x8)).toString(16)\n    })\n    \n    return uuid\n  }\n\nfunction getCwarn() {\n    let t = \"object\" == typeof console ? console.warn : noop;\n    try {\n        let e = {\n            warn: t\n        };\n        e.warn.call(e)\n    } catch (n) {\n        return noop\n    }\n    return t\n}\n\n/**\n * encodeURIComponent 转换\n * @param {*} t \n * @param {*} e \n */\nfunction encode(t, e) {\n    try {\n        t = e ? encodeURIComponent(t).replace(/\\(/g, \"%28\").replace(/\\)/g, \"%29\") : encodeURIComponent(t)\n    } catch (n) { }\n    return t\n}\n\n/**\n * 字符串替换\n * @param {*} str \n * @param {*} find \n * @param {*} replace \n */\nfunction replaceAll(str, find, replace) {\n    return str.replace(new RegExp(find, 'g'), replace);\n}\n\n\n/**\n * @param {*} t \n */\nfunction ext(t) {\n    for (let e = 1, n = arguments.length; e < n; e++) {\n        let r = arguments[e];\n        for (let o in r) {\n            Object.prototype.hasOwnProperty.call(r, o) && (t[o] = r[o])\n        }\n    }\n    return t\n}\n\nlet warn = getCwarn\n\nexport default {\n    ext,\n    warn,\n    encode,\n    replaceAll,\n    generateUUID\n}","\nimport util from '../util/index'\n\nexport default class BaseMonitor {\n    constructor() {\n        this._conf = {\n            baseUrl: '',\n            autoReportApi: true, // 是否上报api \n            autoReportPage: true, // 是否上报页面信息\n            autoReportPagePerformance: true, // 是否上报页面性能\n        }\n    }\n\n    /**\n     * 监控注册\n     * @param {*} e \n     */\n    hookApp(e) {\n        let self = this,\n            t = {\n                onError: function (t) {\n                    let n = 1 === arguments.length ? [arguments[0]] : Array.apply(null, arguments),\n                        r = e.onError;\n                    try {\n                        self.error(t)\n                    } catch (t) {\n                        util.warn(\"[cloudMonitor] error in hookApp:onError\", t)\n                    }\n                    if (\"function\" == typeof r) {\n                        return r.apply(this, n)\n                    }\n                }\n            }\n\n        return util.ext({}, e, t)\n    }\n\n    /**\n     * 监控执行\n     * @param {*} options \n     */\n    init(options) {\n        if (!options || !options.pid) {\n            util.warn(\"[cloudMonitor] not set pid\");\n            return\n        }\n        let self = this\n        try {\n            this.setConfig({}, function() {\n                self.addHook()\n                // 是否需要落pv数据\n                if (self && self._conf && self._conf.autoReportPage) {\n                    self.onReady(() => {\n                        self._log('pv')\n                    })\n                }\n            })\n        } catch (err) {\n            util.warn(\"[cloudMonitor] set config error\");\n        }\n\n\n    }\n\n    /**\n     * @param {*} fun \n     */\n    onReady(fun) {\n        if (typeof fun != 'function') {\n            util.warn('[cloudMonitor] not function')\n            return\n        }\n        this._conf.uid ? fun() : setTimeout(() => {\n            this.onReady(fun)\n        }, 100)\n    }\n\n    /**\n     * 错误信息\n     * @param {*} t \n     * @param {*} e \n     */\n    error(t, e) {\n        if (!t) {\n            return util_1.warn(\"[cloudMonitor] invalid param e: \" + t), this\n        }\n        1 === arguments.length ? (\"string\" == typeof t && (t = {\n            message: t\n        }, e = {}), \"object\" == typeof t && (e = t = t.error || t)) : (\"string\" == typeof t && (t = {\n            message: t\n        }), \"object\" != typeof e && (e = {}));\n        let name = t.name || 'CustomError'\n        let useData = {\n            begin: Date.now(),\n            cate: name,\n            msg: t.message,\n            file: e.filename || \"\",\n            line: e.lineno || \"\",\n            col: e.colno || \"\",\n        }\n\n    }\n\n    getConfig(e) {\n        return {}\n        // return e ? this._conf[e] : util.ext({}, this._conf)\n    }\n\n    /**\n     * 初始化参数\n     * @param {*} options\n     * @param {*} fun \n     */\n    setConfig(options, fun) {\n        this.initQueue()\n        fun()\n    }\n\n    initQueue() { }\n\n    /**\n     * 执行log 存储\n     * @param {*} type \n     */\n    _log(type) {\n        switch (type) {\n            case 'pv':\n                this._logPv()\n                break\n            default:\n\n        }\n    }\n\n    /**\n     * pv 数据\n     */\n    _logPv() {\n\n    }\n\n    /**\n     * 代理\n     */\n    addHook() {\n\n    }\n}","\n/**\n * 消息队列 Base\n */\nexport default class Base {\n    constructor(baseUrl) {\n        this.baseUrl = baseUrl\n        this.requestQueue = [] // 队列\n        this.requestTimmer = undefined\n        this.synRequestNum = 4\n        this.synNum = 0\n        this.retryNum = 1 // 重试上报机制\n    }\n\n    /**\n     * 同步队列 （传入对象必须要有logType，logError）\n     * @param {*} log 队列日志\n     */\n    pushToQueue(log) {\n        {\n            // 简单先同步放入数组中\n            this.requestQueue.push(log)\n            return this.onReady(() => {\n                this.requestTimmer = this.delay(() => {\n                    this.clear()\n                }, this.requestQueue[0] && (!!this.requestQueue[0].logError && this.requestQueue[0].logError > 0) ? 3e3 : -1)\n            })\n        }\n    }\n\n    /**\n     * 宏任务（检测是否有唯一对应值）\n     * @param {*} fun\n     */\n    onReady(fun) {\n        if (typeof fun != 'function') {\n            return\n        }\n        // 检测是否有 openId 如果没有则延迟上报\n        if (fun) {\n            fun()\n        }\n    }\n\n    /**\n     * 执行队列\n     * @param {*} fun\n     * @param {*} e\n     */\n    delay(fun, e) {\n        if (!fun && typeof fun != 'function') return null\n        return e === -1 ? (fun(), null) : setTimeout(fun, e || 0)\n    }\n\n    /**\n     * 并发限制\n     * @return {?}\n     */\n    clear() {\n        var e\n        if (this.synNum > this.synRequestNum) {\n            return clearTimeout(this.requestTimmer), this.requestTimmer = setTimeout(() => {\n                this.clear()\n            }, 50)\n        }\n        for (clearTimeout(this.requestTimmer), this.requestTimmer = null; this.synNum < this.synRequestNum && (e = this.requestQueue.pop()); this.synNum++) {\n            this.handleLog(e)\n        }\n        // 执行完如果还有数据则继续执行（放到宏任务）\n        !!this.requestQueue.length && (this.requestTimmer = setTimeout(() => {\n            this.clear()\n        }, 50))\n\n    }\n\n    /**\n     * 清空队列\n     * @return {?}\n     */\n    clearAll() {\n        this.requestQueue = []\n        this.requestTimmer = null\n        this.synNum = 0\n    }\n\n    /**\n     * 并发数减一\n     * @return {?}\n     */\n    reduceSynNumFun() {\n        Queue.instance.synNum--\n        return this\n    }\n\n    /**\n     * 上报\n     * @param {*} e logType判断上传接口是哪种类型 pv：上报pv 逻辑 mv：上报mv逻辑 logError：0 代码重新上报次数0次，用int后续方便扩展\n     */\n    handleLog(e) {\n        // 深拷贝避免影响其他数据\n        let log = JSON.parse(JSON.stringify(e))\n        try {\n            let param = {\n                viewData: log\n            }\n            this._fetch(param).then(_ => {\n                this.reduceSynNumFun()\n            })\n        } catch (err) {\n            this.reduceSynNumFun()\n        }\n    }\n\n    \n\n}","import Base from './base'\n\n/**\n * 适用于微信消息队列\n */\nexport default class wxQueue extends Base {\n\n    /**\n     * 单例\n     * @param {*} baseUrl\n     * @return {?}\n     */\n    static getInstance(baseUrl) {\n        if (!wxQueue.instance) {\n            wxQueue.instance = new wxQueue(baseUrl)\n        }\n        return wxQueue.instance\n    }\n\n    _fetch(data = {}) {\n        return new Promise(resolve => {\n            wx.request({\n                url: `${this.baseUrl}`,\n                data: data,\n                method: 'POST',\n                dataType: 'json',\n                fail: (res) => {},\n                complete: (res) => {\n                    resolve()\n                }\n            })\n        })\n    }\n}","\nimport BaseMonitor from './base'\nimport wxQueue from '../queue/wx'\n\nexport default class wxMonitor extends BaseMonitor {\n\n    constructor() {\n        super()\n    }\n\n    /**\n     * 单例\n     * @return {?}\n     */\n    static getInstance() {\n        if (!wxMonitor.instance) {\n            wxMonitor.instance = new wxMonitor()\n            wxMonitor.queue = null\n        }\n        return wxMonitor.instance\n    }\n\n    /**\n     * wx 消息队列重写方法\n     */\n    initQueue() {\n        try {\n            // 消息队列初始化\n            wxMonitor.queue = wxQueue.getInstance(this._conf.baseUrl)\n        } catch (err) {\n            util.warn(\"[cloudMonitor] queue init:error\", t)\n        }\n    }\n\n    /**\n     * 微信代理方法\n     */\n    addHook() {\n        let config = this._conf\n        if (config && config.autoReportPage) {\n            if (typeof wx.navigateTo == 'function') {\n                console.log('测试')\n            }\n        }\n\n    }\n\n\n}\n","import wxMonitor from './log/wx'\n\n/**\n * 监控导出\n */\nexport default {\n    wxMonitor\n}"],"names":["generateUUID","uuid","d","Date","getTime","replace","c","r","Math","random","floor","toString","getCwarn","t","console","warn","noop","e","call","n","encode","encodeURIComponent","replaceAll","str","find","RegExp","ext","arguments","length","o","Object","prototype","hasOwnProperty","BaseMonitor","_conf","baseUrl","autoReportApi","autoReportPage","autoReportPagePerformance","self","onError","Array","apply","error","util","options","pid","setConfig","addHook","onReady","_log","err","fun","uid","setTimeout","util_1","message","name","useData","begin","now","cate","msg","file","filename","line","lineno","col","colno","initQueue","type","_logPv","Base","requestQueue","requestTimmer","undefined","synRequestNum","synNum","retryNum","log","push","delay","clear","logError","clearTimeout","pop","handleLog","Queue","instance","JSON","parse","stringify","param","viewData","_fetch","then","_","reduceSynNumFun","wxQueue","data","Promise","resolve","wx","request","url","method","dataType","fail","res","complete","wxMonitor","queue","getInstance","config","navigateTo"],"mappings":"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"}