{"version":3,"file":"index.js","sources":["../src/util/index.js","../src/queue/base.js","../src/queue/wx.js","../src/config/wx.js","../src/log/wxInit.js","../src/log/wx.js","../src/index.js"],"sourcesContent":["/**\n * 校验类型\n * @param {*} type \n */\nfunction isType(type) {\n    return function (value) {\n        return nativeToString.call(value) === \"[object \" + type + \"]\";\n    };\n}\n\n// 校验枚举\nconst variableTypeDetection = {\n    isNumber: isType('Number'),\n    isString: isType('String'),\n    isBoolean: isType('Boolean'),\n    isNull: isType('Null'),\n    isUndefined: isType('Undefined'),\n    isSymbol: isType('Symbol'),\n    isFunction: isType('Function'),\n    isObject: isType('Object'),\n    isArray: isType('Array'),\n    isProcess: isType('process'),\n    isWindow: isType('Window')\n};\n\n/**\n * 生成用户唯一标识码\n */\nfunction generateUUID() {\n    let uuid = '',\n        d = new Date().getTime()\n\n    uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n        let r = (d + Math.random() * 16) % 16 | 0;\n        d = Math.floor(d / 16);\n        return (c == 'x' ? r : (r & 0x3 | 0x8)).toString(16)\n    })\n\n    return uuid\n}\n\nfunction getCwarn() {\n    let t = \"object\" == typeof console ? console.warn : noop;\n    try {\n        let e = {\n            warn: t\n        };\n        e.warn.call(e)\n    } catch (n) {\n        return noop\n    }\n    return t\n}\n\n/**\n * encodeURIComponent 转换\n * @param {*} t \n * @param {*} e \n */\nfunction encode(t, e) {\n    try {\n        t = e ? encodeURIComponent(t).replace(/\\(/g, \"%28\").replace(/\\)/g, \"%29\") : encodeURIComponent(t)\n    } catch (n) { }\n    return t\n}\n\n/**\n * 字符串替换\n * @param {*} str \n * @param {*} find \n * @param {*} replace \n */\nfunction replaceAll(str, find, replace) {\n    return str.replace(new RegExp(find, 'g'), replace);\n}\n\n\n/**\n * @param {*} t \n */\nfunction ext(t) {\n    for (let e = 1, n = arguments.length; e < n; e++) {\n        let r = arguments[e];\n        for (let o in r) {\n            Object.prototype.hasOwnProperty.call(r, o) && (t[o] = r[o])\n        }\n    }\n    return t\n}\n\n/**\n * 日期格式化\n * @param {*} date \n * @param {*} fmt \n */\nfunction dateFormat(date, fmt) {\n    if (!date || !(date instanceof Date)) {\n        return \"\";\n    }\n    var o = {\n        \"M+\": date.getMonth() + 1, // 月份\n        \"d+\": date.getDate(), // 日\n        \"h+\": date.getHours(), // 小时\n        \"m+\": date.getMinutes(), // 分\n        \"s+\": date.getSeconds(), // 秒\n        \"q+\": Math.floor((date.getMonth() + 3) / 3), // 季度\n        \"S\": date.getMilliseconds() // 毫秒\n    };\n    if (/(y+)/.test(fmt))\n        fmt = fmt.replace(RegExp.$1, (date.getFullYear() + \"\").substr(4 - RegExp.$1.length));\n    for (var k in o)\n        if (new RegExp(\"(\" + k + \")\").test(fmt))\n            fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : ((\"00\" + o[k]).substr((\"\" + o[k]).length)));\n    return fmt;\n}\n\n/**\n * 合并\n */\nfunction __assign() {\n    __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n\n/**\n * 获取当前url\n */\nfunction getPage() {\n    return getCurrentPages()[getCurrentPages().length - 1].__route__\n}\n\n/**\n * url\n * @param {*} url \n * @param {*} query \n */\nfunction setUrlQuery(url, query) {\n    var queryArr = [];\n    Object.keys(query).forEach(function (k) {\n        queryArr.push(k + \"=\" + query[k]);\n    });\n    if (url.indexOf('?') !== -1) {\n        url = url + \"&\" + queryArr.join('&');\n    }\n    else {\n        url = url + \"?\" + queryArr.join('&');\n    }\n    return url;\n}\n\n/**\n * \n * @param {*} delta \n */\nfunction getNavigateBackTargetUrl(delta) {\n    if (!variableTypeDetection.isFunction(getCurrentPages)) {\n        return '';\n    }\n    var pages = getCurrentPages();\n    if (!pages.length) {\n        return 'App';\n    }\n    delta = delta || 1;\n    var toPage = pages[pages.length - delta];\n    return setUrlQuery(toPage.route, toPage.options);\n}\n\nlet warn = getCwarn\n\nexport default {\n    ext,\n    warn,\n    encode,\n    replaceAll,\n    generateUUID,\n    dateFormat,\n    getPage,\n    getNavigateBackTargetUrl,\n    __assign\n}","\n/**\n * 消息队列 Base\n */\nexport default class Base {\n    constructor(baseUrl) {\n        this.baseUrl = baseUrl\n        this.requestQueue = [] // 队列\n        this.requestTimmer = undefined\n        this.synRequestNum = 4\n        this.synNum = 0\n        this.retryNum = 1 // 重试上报机制\n    }\n\n    /**\n     * 同步队列 （传入对象必须要有logType，logError）\n     * @param {*} log 队列日志\n     */\n    pushToQueue(log) {\n        {\n            // 简单先同步放入数组中\n            this.requestQueue.push(log)\n            return this.onReady(() => {\n                this.requestTimmer = this.delay(() => {\n                    this.clear()\n                }, this.requestQueue[0] && (!!this.requestQueue[0].logError && this.requestQueue[0].logError > 0) ? 3e3 : -1)\n            })\n        }\n    }\n\n    /**\n     * 宏任务（检测是否有唯一对应值）\n     * @param {*} fun\n     */\n    onReady(fun) {\n        if (typeof fun != 'function') {\n            return\n        }\n        // 检测是否有 openId 如果没有则延迟上报\n        if (fun) {\n            fun()\n        }\n    }\n\n    /**\n     * 执行队列\n     * @param {*} fun\n     * @param {*} e\n     */\n    delay(fun, e) {\n        if (!fun && typeof fun != 'function') return null\n        return e === -1 ? (fun(), null) : setTimeout(fun, e || 0)\n    }\n\n    /**\n     * 并发限制\n     * @return {?}\n     */\n    clear() {\n        var e\n        if (this.synNum > this.synRequestNum) {\n            return clearTimeout(this.requestTimmer), this.requestTimmer = setTimeout(() => {\n                this.clear()\n            }, 50)\n        }\n        for (clearTimeout(this.requestTimmer), this.requestTimmer = null; this.synNum < this.synRequestNum && (e = this.requestQueue.pop()); this.synNum++) {\n            this.handleLog(e)\n        }\n        // 执行完如果还有数据则继续执行（放到宏任务）\n        !!this.requestQueue.length && (this.requestTimmer = setTimeout(() => {\n            this.clear()\n        }, 50))\n\n    }\n\n    /**\n     * 清空队列\n     * @return {?}\n     */\n    clearAll() {\n        this.requestQueue = []\n        this.requestTimmer = null\n        this.synNum = 0\n    }\n\n    /**\n     * 并发数减一\n     * @return {?}\n     */\n    reduceSynNumFun() {\n        \n    }\n\n    /**\n     * 上报\n     * @param {*} e logType判断上传接口是哪种类型 pv：上报pv 逻辑 mv：上报mv逻辑 logError：0 代码重新上报次数0次，用int后续方便扩展\n     */\n    handleLog(e) {\n        // 深拷贝避免影响其他数据\n        let log = JSON.parse(JSON.stringify(e))\n        try {\n            this._fetch(log).then(_ => {\n                this.reduceSynNumFun()\n            })\n        } catch (err) {\n            this.reduceSynNumFun()\n        }\n    }\n\n    \n\n}","import Base from './base'\n\n/**\n * 适用于微信消息队列\n */\nexport default class wxQueue extends Base {\n\n    /**\n     * 单例\n     * @param {*} baseUrl\n     * @return {?}\n     */\n    static getInstance(baseUrl) {\n        if (!wxQueue.instance) {\n            wxQueue.instance = new wxQueue(baseUrl)\n        }\n        return wxQueue.instance\n    }\n\n    /**\n     * 并发数减一\n     * @return {?}\n     */\n    reduceSynNumFun() {\n        wxQueue.instance.synNum--\n        return this\n    }\n\n    _fetch(data = {}) {\n        return new Promise(resolve => {\n            wx.request({\n                url: `${this.baseUrl}/api/save/log`,\n                data: data,\n                method: 'POST',\n                dataType: 'json',\n                fail: (res) => {},\n                complete: (res) => {\n                    resolve()\n                }\n            })\n        })\n    }\n}","export const WxRouteEvents = ['switchTab', 'reLaunch', 'redirectTo', 'navigateTo', 'navigateBack', 'routeFail']\nexport const WxHookMethods = ['request']\nexport const WX_TYPE = 2\nexport const WX_PROJECT_VERSION = '1.0.0' // 项目版本号\nexport const HTTP_SUCCESS = 1\nexport const HTTP_ERROR = 2\n","import util from '../util/index'\nimport wxQueue from '../queue/wx'\nimport * as config from '../config/wx'\n\nconst baseConfig = {\n    baseUrl: '',\n    autoReportApi: true, // 是否上报api \n    autoReportPage: true, // 是否上报页面信息\n    autoReportPagePerformance: true, // 是否上报页面性能\n}\n\n/**\n * 初始化微信sdk\n * @param {*} wxMonitor \n */\nexport function initMixin(wxMonitor) {\n    /**\n     * 初始化\n     * @param {*} options \n     */\n    wxMonitor._init = function (options) {\n        const vm = this\n        if (!options || !options.app) {\n            util.warn('[cloudMonitor] not set app')\n        }\n        if (!options || !options.baseUrl) {\n            util.warn('[cloudMonitor] not set baseUrl')\n        }\n        let _options = Object.assign(baseConfig, options)\n        vm.$options = _options\n        vm.queue = wxQueue.getInstance(_options.baseUrl)\n        // 初始化\n        vm.baseOptions = '' // 初始化上传参数\n        vm.referrerPage = '' // 上一个页面\n        vm.userId = '' // 用户唯一标识\n        vm.initBaseOptions(_options)\n        vm.$addHook(_options)\n    }\n    /**\n     * 微信代理\n     * @param {*} options \n     */\n    wxMonitor.$addHook = function (options) {\n        const vm = this\n        // 代理跳转\n        let WxRouteEvents = config.WxRouteEvents\n        WxRouteEvents.forEach(method => {\n            let originMethod = wx[method];\n            Object.defineProperty(wx, method, {\n                writable: true,\n                enumerable: true,\n                configurable: true,\n                value: function (options) {\n                    var toUrl;\n                    if (method === WxRouteEvents.NavigateBack) {\n                        toUrl = util.getNavigateBackTargetUrl(options.delta);\n                    } else {\n                        toUrl = options.url;\n                    }\n                    try {\n                        let data = {\n                            simpleUrl: toUrl,\n                            referrer: vm.referrerPage || \"\",\n                        }\n                        vm.logSave('page_pv', data)\n                        vm.referrerPage = toUrl\n                    } catch (e) {\n                        util.warn('[cloudMonitor] url error')\n                    }\n                    return originMethod.call(this, options);\n                }\n            })\n        })\n        // 代理请求\n        let WxHookMethods = config.WxHookMethods\n        WxHookMethods.forEach(hook => {\n            let originRequest = wx[hook];\n            Object.defineProperty(wx, hook, {\n                writable: true,\n                enumerable: true,\n                configurable: true,\n                value: function () {\n                    let args = [];\n                    let startTime = new Date().getTime()\n                    for (let _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    let options$1 = args[0];\n                    let url = options$1.url || \"\"\n\n                    let reqData;\n                    if (hook === 'request') {\n                        reqData = options$1.data;\n                    }\n                    let successHandler = function (res) {\n                        try {\n                            // 上报接口报警\n                            if (!!res && res.statusCode && res.statusCode != 200) {\n                                let data = {\n                                    simpleUrl: util.getPage(),\n                                    httpUrl: options$1.url || \"\",\n                                    httpUploadType: config.HTTP_ERROR,\n                                    responseText: JSON.stringify(res),\n                                    httpStatus: res.statusCode\n                                }\n                                if (url && url.indexOf(vm.baseUrl) != -1) {\n                                    vm.logSave('http_log', data)\n                                }\n                            } else {\n                                let endTime = new Date().getTime()\n                                let consumeData = {\n                                    simpleUrl: util.getPage(),\n                                    loadTime: endTime - startTime,\n                                    httpUrl: options$1.url || \"\",\n                                    httpUploadType: config.HTTP_SUCCESS,\n                                    responseText: JSON.stringify(res),\n                                    httpStatus: res.statusCode || 200\n                                }\n                                if (url && url.indexOf(vm.baseUrl) != -1) {\n                                    vm.logSave('http_log', consumeData)\n                                }\n                            }\n                        } catch (e) {\n                            util.warn('[cloudMonitor] http error')\n                        }\n                        if (typeof options$1.success === 'function') {\n                            return options$1.success(res);\n                        }\n                    };\n                    let failHandler = function (err) {\n                        try {\n                            let data = {\n                                simpleUrl: util.getPage(),\n                                httpUrl: options$1.url || \"\",\n                                httpUploadType: config.HTTP_ERROR,\n                                responseText: JSON.stringify(err),\n                                httpStatus: '0'\n                            }\n                            if (url && url.indexOf(vm.baseUrl) != -1) {\n                                vm.logSave('http_log', data)\n                            }\n                        } catch (e) {\n                            util.warn('[cloudMonitor] http error')\n                        }\n                        if (typeof options$1.fail === 'function') {\n                            return options$1.fail(err);\n                        }\n                    };\n                    let actOptions = util.__assign(util.__assign({}, options$1), { success: successHandler, fail: failHandler });\n                    return originRequest.call(this, actOptions);\n                }\n            })\n        })\n    }\n    /**\n     * 上传日志\n     * @param {*} type \n     * @param {*} data \n     */\n    wxMonitor.logSave = function (type, data) {\n        let useData,\n            logData = JSON.parse(JSON.stringify(data)),\n            vm = this\n        if (!vm.baseOptions) {\n            vm.initBaseOptions(vm.options)\n            setTimeout(() => {\n                logSave(type, data)\n            }, 500)\n            return\n        }\n        switch (type) {\n            case 'page_pv':\n                useData = Object.assign(logData, vm.baseOptions)\n                useData.userId = vm.userId || \"\", // 用户标识\n                    useData.uploadType = type\n                useData.mobileTime = util.dateFormat(new Date(), 'yyyy-MM-dd hh:mm:ss')\n                vm.queue.pushToQueue(useData)\n                break\n            case 'js_error':\n                useData = Object.assign(logData, vm.baseOptions)\n                useData.userId = vm.userId || \"\", // 用户标识\n                    useData.uploadType = type\n                useData.mobileTime = util.dateFormat(new Date(), 'yyyy-MM-dd hh:mm:ss')\n                vm.queue.pushToQueue(useData)\n                break\n            case 'http_log':\n                useData = Object.assign(logData, vm.baseOptions)\n                useData.userId = vm.userId || \"\", // 用户标识\n                    useData.uploadType = type\n                useData.mobileTime = util.dateFormat(new Date(), 'yyyy-MM-dd hh:mm:ss')\n                vm.queue.pushToQueue(useData)\n                break\n            default:\n\n        }\n    }\n\n    /**\n     * 初始化上传参数\n     * @param {*} option \n     */\n    wxMonitor.initBaseOptions = function (option) {\n        let vm = this\n        // 初始化上传参数\n        wx.getSystemInfo({\n            success: (res) => {\n                vm.baseOptions = {\n                    app: option.app || \"\",\n                    type: config.WX_TYPE, // 代表微信小程序\n                    projectVersion: option.projectVersion || config.WX_PROJECT_VERSION, // 项目版本号\n                    customerKey: util.generateUUID(), // 会话id\n                    os: res.system.indexOf('iOS') === -1 ? 'Android' : 'IOS', // 系统信息\n                    deviceName: res.model, // 手机型号\n                    brand: res.brand, // 手机品牌\n                    browserVersion: res.version, // 小程序版本号\n                }\n            }\n        });\n    }\n    /**\n     * 设置用户唯一标识\n     * @param {*} userId \n     */\n    wxMonitor.setUserId = function (userId) {\n        this.userId = userId\n    }\n    /**\n     * 包装js 错误信息\n     * @param {*} option \n     */\n    wxMonitor.hookApp = function (option) {\n        let vm = this,\n            oldHookApp = {\n                onError: function (e) {\n                    var n = 1 === arguments.length ? [arguments[0]] : Array.apply(null, arguments),\n                        r = option.onError;\n                    try {\n                        let data = {\n                            simpleUrl: util.getPage(),\n                            errorMessage: String(e)\n                        }\n                        vm.logSave('js_error', data)\n                    } catch (err) {\n                        util.warn(\"[cloudMonitor] error in hookApp:onError\", err)\n                    }\n                    if (\"function\" == typeof r) {\n                        return r.apply(this, n)\n                    }\n                }\n            }\n        return util.ext({}, option, oldHookApp)\n\n    }\n}","import { initMixin } from './wxInit'\n\nlet wxMonitor = {}\n\nwxMonitor.init = function(options) {\n    this._init(options)\n}\n\ninitMixin(wxMonitor)\n\n\nexport default wxMonitor","import wxMonitor from './log/wx'\n\n/**\n * 监控导出\n */\nexport default {\n    wxMonitor\n}"],"names":["isType","type","value","nativeToString","call","variableTypeDetection","isNumber","isString","isBoolean","isNull","isUndefined","isSymbol","isFunction","isObject","isArray","isProcess","isWindow","generateUUID","uuid","d","Date","getTime","replace","c","r","Math","random","floor","toString","getCwarn","t","console","warn","noop","e","n","encode","encodeURIComponent","replaceAll","str","find","RegExp","ext","arguments","length","o","Object","prototype","hasOwnProperty","dateFormat","date","fmt","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","test","$1","getFullYear","substr","k","__assign","assign","s","i","p","apply","getPage","getCurrentPages","__route__","setUrlQuery","url","query","queryArr","keys","forEach","push","indexOf","join","getNavigateBackTargetUrl","delta","pages","toPage","route","options","Base","baseUrl","requestQueue","requestTimmer","undefined","synRequestNum","synNum","retryNum","log","onReady","delay","clear","logError","fun","setTimeout","clearTimeout","pop","handleLog","JSON","parse","stringify","_fetch","then","_","reduceSynNumFun","err","wxQueue","instance","data","Promise","resolve","wx","request","method","dataType","fail","res","complete","WxRouteEvents","WxHookMethods","WX_TYPE","WX_PROJECT_VERSION","HTTP_SUCCESS","HTTP_ERROR","baseConfig","autoReportApi","autoReportPage","autoReportPagePerformance","initMixin","wxMonitor","_init","vm","app","util","_options","$options","queue","getInstance","baseOptions","referrerPage","userId","initBaseOptions","$addHook","config","originMethod","defineProperty","writable","enumerable","configurable","toUrl","NavigateBack","simpleUrl","referrer","logSave","hook","originRequest","args","startTime","_i","options$1","reqData","successHandler","statusCode","httpUrl","httpUploadType","responseText","httpStatus","endTime","consumeData","loadTime","success","failHandler","actOptions","useData","logData","uploadType","mobileTime","pushToQueue","option","getSystemInfo","projectVersion","customerKey","os","system","deviceName","model","brand","browserVersion","version","setUserId","hookApp","oldHookApp","onError","Array","errorMessage","String","init"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA,SAASA,MAAT,CAAgBC,IAAhB,EAAsB;AAClB,SAAO,UAAUC,KAAV,EAAiB;AACpB,WAAOC,cAAc,CAACC,IAAf,CAAoBF,KAApB,MAA+B,aAAaD,IAAb,GAAoB,GAA1D;AACH,GAFD;AAGH;;;AAGD,IAAMI,qBAAqB,GAAG;AAC1BC,EAAAA,QAAQ,EAAEN,MAAM,CAAC,QAAD,CADU;AAE1BO,EAAAA,QAAQ,EAAEP,MAAM,CAAC,QAAD,CAFU;AAG1BQ,EAAAA,SAAS,EAAER,MAAM,CAAC,SAAD,CAHS;AAI1BS,EAAAA,MAAM,EAAET,MAAM,CAAC,MAAD,CAJY;AAK1BU,EAAAA,WAAW,EAAEV,MAAM,CAAC,WAAD,CALO;AAM1BW,EAAAA,QAAQ,EAAEX,MAAM,CAAC,QAAD,CANU;AAO1BY,EAAAA,UAAU,EAAEZ,MAAM,CAAC,UAAD,CAPQ;AAQ1Ba,EAAAA,QAAQ,EAAEb,MAAM,CAAC,QAAD,CARU;AAS1Bc,EAAAA,OAAO,EAAEd,MAAM,CAAC,OAAD,CATW;AAU1Be,EAAAA,SAAS,EAAEf,MAAM,CAAC,SAAD,CAVS;AAW1BgB,EAAAA,QAAQ,EAAEhB,MAAM,CAAC,QAAD;AAXU,CAA9B;AAcA;AACA;AACA;;AACA,SAASiB,YAAT,GAAwB;AACpB,MAAIC,IAAI,GAAG,EAAX;AAAA,MACIC,CAAC,GAAG,IAAIC,IAAJ,GAAWC,OAAX,EADR;AAGAH,EAAAA,IAAI,GAAG,uCAAuCI,OAAvC,CAA+C,OAA/C,EAAwD,UAACC,CAAD,EAAO;AAClE,QAAIC,CAAC,GAAG,CAACL,CAAC,GAAGM,IAAI,CAACC,MAAL,KAAgB,EAArB,IAA2B,EAA3B,GAAgC,CAAxC;AACAP,IAAAA,CAAC,GAAGM,IAAI,CAACE,KAAL,CAAWR,CAAC,GAAG,EAAf,CAAJ;AACA,WAAO,CAACI,CAAC,IAAI,GAAL,GAAWC,CAAX,GAAgBA,CAAC,GAAG,GAAJ,GAAU,GAA3B,EAAiCI,QAAjC,CAA0C,EAA1C,CAAP;AACH,GAJM,CAAP;AAMA,SAAOV,IAAP;AACH;;AAED,SAASW,QAAT,GAAoB;AAChB,MAAIC,CAAC,GAAG,oBAAmBC,OAAnB,yCAAmBA,OAAnB,KAA6BA,OAAO,CAACC,IAArC,GAA4CC,IAApD;;AACA,MAAI;AACA,QAAIC,CAAC,GAAG;AACJF,MAAAA,IAAI,EAAEF;AADF,KAAR;AAGAI,IAAAA,CAAC,CAACF,IAAF,CAAO5B,IAAP,CAAY8B,CAAZ;AACH,GALD,CAKE,OAAOC,CAAP,EAAU;AACR,WAAOF,IAAP;AACH;;AACD,SAAOH,CAAP;AACH;AAED;AACA;AACA;AACA;AACA;;;AACA,SAASM,MAAT,CAAgBN,CAAhB,EAAmBI,CAAnB,EAAsB;AAClB,MAAI;AACAJ,IAAAA,CAAC,GAAGI,CAAC,GAAGG,kBAAkB,CAACP,CAAD,CAAlB,CAAsBR,OAAtB,CAA8B,KAA9B,EAAqC,KAArC,EAA4CA,OAA5C,CAAoD,KAApD,EAA2D,KAA3D,CAAH,GAAuEe,kBAAkB,CAACP,CAAD,CAA9F;AACH,GAFD,CAEE,OAAOK,CAAP,EAAU;;AACZ,SAAOL,CAAP;AACH;AAED;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASQ,UAAT,CAAoBC,GAApB,EAAyBC,IAAzB,EAA+BlB,OAA/B,EAAwC;AACpC,SAAOiB,GAAG,CAACjB,OAAJ,CAAY,IAAImB,MAAJ,CAAWD,IAAX,EAAiB,GAAjB,CAAZ,EAAmClB,OAAnC,CAAP;AACH;AAGD;AACA;AACA;;;AACA,SAASoB,GAAT,CAAaZ,CAAb,EAAgB;AACZ,OAAK,IAAII,CAAC,GAAG,CAAR,EAAWC,CAAC,GAAGQ,SAAS,CAACC,MAA9B,EAAsCV,CAAC,GAAGC,CAA1C,EAA6CD,CAAC,EAA9C,EAAkD;AAC9C,QAAIV,CAAC,GAAGmB,SAAS,CAACT,CAAD,CAAjB;;AACA,SAAK,IAAIW,CAAT,IAAcrB,CAAd,EAAiB;AACbsB,MAAAA,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgC5C,IAAhC,CAAqCoB,CAArC,EAAwCqB,CAAxC,MAA+Cf,CAAC,CAACe,CAAD,CAAD,GAAOrB,CAAC,CAACqB,CAAD,CAAvD;AACH;AACJ;;AACD,SAAOf,CAAP;AACH;AAED;AACA;AACA;AACA;AACA;;;AACA,SAASmB,UAAT,CAAoBC,IAApB,EAA0BC,GAA1B,EAA+B;AAC3B,MAAI,CAACD,IAAD,IAAS,EAAEA,IAAI,YAAY9B,IAAlB,CAAb,EAAsC;AAClC,WAAO,EAAP;AACH;;AACD,MAAIyB,CAAC,GAAG;AACJ,UAAMK,IAAI,CAACE,QAAL,KAAkB,CADpB;AACuB;AAC3B,UAAMF,IAAI,CAACG,OAAL,EAFF;AAEkB;AACtB,UAAMH,IAAI,CAACI,QAAL,EAHF;AAGmB;AACvB,UAAMJ,IAAI,CAACK,UAAL,EAJF;AAIqB;AACzB,UAAML,IAAI,CAACM,UAAL,EALF;AAKqB;AACzB,UAAM/B,IAAI,CAACE,KAAL,CAAW,CAACuB,IAAI,CAACE,QAAL,KAAkB,CAAnB,IAAwB,CAAnC,CANF;AAMyC;AAC7C,SAAKF,IAAI,CAACO,eAAL,EAPD;;AAAA,GAAR;AASA,MAAI,OAAOC,IAAP,CAAYP,GAAZ,CAAJ,EACIA,GAAG,GAAGA,GAAG,CAAC7B,OAAJ,CAAYmB,MAAM,CAACkB,EAAnB,EAAuB,CAACT,IAAI,CAACU,WAAL,KAAqB,EAAtB,EAA0BC,MAA1B,CAAiC,IAAIpB,MAAM,CAACkB,EAAP,CAAUf,MAA/C,CAAvB,CAAN;;AACJ,OAAK,IAAIkB,CAAT,IAAcjB,CAAd;AACI,QAAI,IAAIJ,MAAJ,CAAW,MAAMqB,CAAN,GAAU,GAArB,EAA0BJ,IAA1B,CAA+BP,GAA/B,CAAJ,EACIA,GAAG,GAAGA,GAAG,CAAC7B,OAAJ,CAAYmB,MAAM,CAACkB,EAAnB,EAAwBlB,MAAM,CAACkB,EAAP,CAAUf,MAAV,IAAoB,CAArB,GAA2BC,CAAC,CAACiB,CAAD,CAA5B,GAAoC,CAAC,OAAOjB,CAAC,CAACiB,CAAD,CAAT,EAAcD,MAAd,CAAqB,CAAC,KAAKhB,CAAC,CAACiB,CAAD,CAAP,EAAYlB,MAAjC,CAA3D,CAAN;AAFR;;AAGA,SAAOO,GAAP;AACH;AAED;AACA;AACA;;;AACA,SAASY,QAAT,GAAoB;AAChBA,EAAAA,QAAQ,GAAGjB,MAAM,CAACkB,MAAP,IAAiB,SAASD,QAAT,CAAkBjC,CAAlB,EAAqB;AAC7C,SAAK,IAAImC,CAAJ,EAAOC,CAAC,GAAG,CAAX,EAAc/B,CAAC,GAAGQ,SAAS,CAACC,MAAjC,EAAyCsB,CAAC,GAAG/B,CAA7C,EAAgD+B,CAAC,EAAjD,EAAqD;AACjDD,MAAAA,CAAC,GAAGtB,SAAS,CAACuB,CAAD,CAAb;;AACA,WAAK,IAAIC,CAAT,IAAcF,CAAd;AAAiB,YAAInB,MAAM,CAACC,SAAP,CAAiBC,cAAjB,CAAgC5C,IAAhC,CAAqC6D,CAArC,EAAwCE,CAAxC,CAAJ,EAAgDrC,CAAC,CAACqC,CAAD,CAAD,GAAOF,CAAC,CAACE,CAAD,CAAR;AAAjE;AACH;;AACD,WAAOrC,CAAP;AACH,GAND;;AAOA,SAAOiC,QAAQ,CAACK,KAAT,CAAe,IAAf,EAAqBzB,SAArB,CAAP;AACH;AAED;AACA;AACA;;AACA,SAAS0B,OAAT,GAAmB;AACf,SAAOC,eAAe,GAAGA,eAAe,GAAG1B,MAAlB,GAA2B,CAA9B,CAAf,CAAgD2B,SAAvD;AACH;AAED;AACA;AACA;AACA;AACA;;;AACA,SAASC,WAAT,CAAqBC,GAArB,EAA0BC,KAA1B,EAAiC;AAC7B,MAAIC,QAAQ,GAAG,EAAf;AACA7B,EAAAA,MAAM,CAAC8B,IAAP,CAAYF,KAAZ,EAAmBG,OAAnB,CAA2B,UAAUf,CAAV,EAAa;AACpCa,IAAAA,QAAQ,CAACG,IAAT,CAAchB,CAAC,GAAG,GAAJ,GAAUY,KAAK,CAACZ,CAAD,CAA7B;AACH,GAFD;;AAGA,MAAIW,GAAG,CAACM,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAA1B,EAA6B;AACzBN,IAAAA,GAAG,GAAGA,GAAG,GAAG,GAAN,GAAYE,QAAQ,CAACK,IAAT,CAAc,GAAd,CAAlB;AACH,GAFD,MAGK;AACDP,IAAAA,GAAG,GAAGA,GAAG,GAAG,GAAN,GAAYE,QAAQ,CAACK,IAAT,CAAc,GAAd,CAAlB;AACH;;AACD,SAAOP,GAAP;AACH;AAED;AACA;AACA;AACA;;;AACA,SAASQ,wBAAT,CAAkCC,KAAlC,EAAyC;AACrC,MAAI,CAAC7E,qBAAqB,CAACO,UAAtB,CAAiC0D,eAAjC,CAAL,EAAwD;AACpD,WAAO,EAAP;AACH;;AACD,MAAIa,KAAK,GAAGb,eAAe,EAA3B;;AACA,MAAI,CAACa,KAAK,CAACvC,MAAX,EAAmB;AACf,WAAO,KAAP;AACH;;AACDsC,EAAAA,KAAK,GAAGA,KAAK,IAAI,CAAjB;AACA,MAAIE,MAAM,GAAGD,KAAK,CAACA,KAAK,CAACvC,MAAN,GAAesC,KAAhB,CAAlB;AACA,SAAOV,WAAW,CAACY,MAAM,CAACC,KAAR,EAAeD,MAAM,CAACE,OAAtB,CAAlB;AACH;;AAED,IAAItD,IAAI,GAAGH,QAAX;AAEA,WAAe;AACXa,EAAAA,GAAG,EAAHA,GADW;AAEXV,EAAAA,IAAI,EAAJA,IAFW;AAGXI,EAAAA,MAAM,EAANA,MAHW;AAIXE,EAAAA,UAAU,EAAVA,UAJW;AAKXrB,EAAAA,YAAY,EAAZA,YALW;AAMXgC,EAAAA,UAAU,EAAVA,UANW;AAOXoB,EAAAA,OAAO,EAAPA,OAPW;AAQXY,EAAAA,wBAAwB,EAAxBA,wBARW;AASXlB,EAAAA,QAAQ,EAARA;AATW,CAAf;;AC9KA;AACA;AACA;IACqBwB;AACjB,gBAAYC,OAAZ,EAAqB;AAAA;;AACjB,SAAKA,OAAL,GAAeA,OAAf;AACA,SAAKC,YAAL,GAAoB,EAApB,CAFiB;;AAGjB,SAAKC,aAAL,GAAqBC,SAArB;AACA,SAAKC,aAAL,GAAqB,CAArB;AACA,SAAKC,MAAL,GAAc,CAAd;AACA,SAAKC,QAAL,GAAgB,CAAhB,CANiB;AAOpB;AAED;AACJ;AACA;AACA;;;;;gCACgBC,KAAK;AAAA;;AACb;AACI;AACA,aAAKN,YAAL,CAAkBX,IAAlB,CAAuBiB,GAAvB;AACA,eAAO,KAAKC,OAAL,CAAa,YAAM;AACtB,UAAA,KAAI,CAACN,aAAL,GAAqB,KAAI,CAACO,KAAL,CAAW,YAAM;AAClC,YAAA,KAAI,CAACC,KAAL;AACH,WAFoB,EAElB,KAAI,CAACT,YAAL,CAAkB,CAAlB,KAAyB,CAAC,CAAC,KAAI,CAACA,YAAL,CAAkB,CAAlB,EAAqBU,QAAvB,IAAmC,KAAI,CAACV,YAAL,CAAkB,CAAlB,EAAqBU,QAArB,GAAgC,CAA5F,GAAiG,GAAjG,GAAuG,CAAC,CAFtF,CAArB;AAGH,SAJM,CAAP;AAKH;AACJ;AAED;AACJ;AACA;AACA;;;;4BACYC,KAAK;AACT,UAAI,OAAOA,GAAP,IAAc,UAAlB,EAA8B;AAC1B;AACH,OAHQ;;;AAKT,UAAIA,GAAJ,EAAS;AACLA,QAAAA,GAAG;AACN;AACJ;AAED;AACJ;AACA;AACA;AACA;;;;0BACUA,KAAKlE,GAAG;AACV,UAAI,CAACkE,GAAD,IAAQ,OAAOA,GAAP,IAAc,UAA1B,EAAsC,OAAO,IAAP;AACtC,aAAOlE,CAAC,KAAK,CAAC,CAAP,IAAYkE,GAAG,IAAI,IAAnB,IAA2BC,UAAU,CAACD,GAAD,EAAMlE,CAAC,IAAI,CAAX,CAA5C;AACH;AAED;AACJ;AACA;AACA;;;;4BACY;AAAA;;AACJ,UAAIA,CAAJ;;AACA,UAAI,KAAK2D,MAAL,GAAc,KAAKD,aAAvB,EAAsC;AAClC,eAAOU,YAAY,CAAC,KAAKZ,aAAN,CAAZ,EAAkC,KAAKA,aAAL,GAAqBW,UAAU,CAAC,YAAM;AAC3E,UAAA,MAAI,CAACH,KAAL;AACH,SAFuE,EAErE,EAFqE,CAAxE;AAGH;;AACD,WAAKI,YAAY,CAAC,KAAKZ,aAAN,CAAZ,EAAkC,KAAKA,aAAL,GAAqB,IAA5D,EAAkE,KAAKG,MAAL,GAAc,KAAKD,aAAnB,KAAqC1D,CAAC,GAAG,KAAKuD,YAAL,CAAkBc,GAAlB,EAAzC,CAAlE,EAAqI,KAAKV,MAAL,EAArI,EAAoJ;AAChJ,aAAKW,SAAL,CAAetE,CAAf;AACH,OATG;;;AAWJ,OAAC,CAAC,KAAKuD,YAAL,CAAkB7C,MAApB,KAA+B,KAAK8C,aAAL,GAAqBW,UAAU,CAAC,YAAM;AACjE,QAAA,MAAI,CAACH,KAAL;AACH,OAF6D,EAE3D,EAF2D,CAA9D;AAIH;AAED;AACJ;AACA;AACA;;;;+BACe;AACP,WAAKT,YAAL,GAAoB,EAApB;AACA,WAAKC,aAAL,GAAqB,IAArB;AACA,WAAKG,MAAL,GAAc,CAAd;AACH;AAED;AACJ;AACA;AACA;;;;sCACsB;AAIlB;AACJ;AACA;AACA;;;;8BACc3D,GAAG;AAAA;;AACT;AACA,UAAI6D,GAAG,GAAGU,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAezE,CAAf,CAAX,CAAV;;AACA,UAAI;AACA,aAAK0E,MAAL,CAAYb,GAAZ,EAAiBc,IAAjB,CAAsB,UAAAC,CAAC,EAAI;AACvB,UAAA,MAAI,CAACC,eAAL;AACH,SAFD;AAGH,OAJD,CAIE,OAAOC,GAAP,EAAY;AACV,aAAKD,eAAL;AACH;AACJ;;;;;;ACzGL;AACA;AACA;;IACqBE;;;;;;;;;;;;;;AAcjB;AACJ;AACA;AACA;sCACsB;AACdA,MAAAA,OAAO,CAACC,QAAR,CAAiBrB,MAAjB;AACA,aAAO,IAAP;AACH;;;6BAEiB;AAAA;;AAAA,UAAXsB,IAAW,uEAAJ,EAAI;AACd,aAAO,IAAIC,OAAJ,CAAY,UAAAC,OAAO,EAAI;AAC1BC,QAAAA,EAAE,CAACC,OAAH,CAAW;AACP9C,UAAAA,GAAG,YAAK,KAAI,CAACe,OAAV,kBADI;AAEP2B,UAAAA,IAAI,EAAEA,IAFC;AAGPK,UAAAA,MAAM,EAAE,MAHD;AAIPC,UAAAA,QAAQ,EAAE,MAJH;AAKPC,UAAAA,IAAI,EAAE,cAACC,GAAD,EAAS,EALR;AAMPC,UAAAA,QAAQ,EAAE,kBAACD,GAAD,EAAS;AACfN,YAAAA,OAAO;AACV;AARM,SAAX;AAUH,OAXM,CAAP;AAYH;;;;AAlCD;AACJ;AACA;AACA;AACA;gCACuB7B,SAAS;AACxB,UAAI,CAACyB,OAAO,CAACC,QAAb,EAAuB;AACnBD,QAAAA,OAAO,CAACC,QAAR,GAAmB,IAAID,OAAJ,CAAYzB,OAAZ,CAAnB;AACH;;AACD,aAAOyB,OAAO,CAACC,QAAf;AACH;;;;EAZgC3B;;ACL9B,IAAMsC,aAAa,GAAG,CAAC,WAAD,EAAc,UAAd,EAA0B,YAA1B,EAAwC,YAAxC,EAAsD,cAAtD,EAAsE,WAAtE,CAAtB;AACA,IAAMC,aAAa,GAAG,CAAC,SAAD,CAAtB;AACA,IAAMC,OAAO,GAAG,CAAhB;AACA,IAAMC,kBAAkB,GAAG,OAA3B;;AACA,IAAMC,YAAY,GAAG,CAArB;AACA,IAAMC,UAAU,GAAG,CAAnB;;ACDP,IAAMC,UAAU,GAAG;AACf3C,EAAAA,OAAO,EAAE,EADM;AAEf4C,EAAAA,aAAa,EAAE,IAFA;AAEM;AACrBC,EAAAA,cAAc,EAAE,IAHD;AAGO;AACtBC,EAAAA,yBAAyB,EAAE,IAJZ;;AAAA,CAAnB;AAOA;AACA;AACA;AACA;;AACO,SAASC,SAAT,CAAmBC,SAAnB,EAA8B;AACjC;AACJ;AACA;AACA;AACIA,EAAAA,SAAS,CAACC,KAAV,GAAkB,UAAUnD,OAAV,EAAmB;AACjC,QAAMoD,EAAE,GAAG,IAAX;;AACA,QAAI,CAACpD,OAAD,IAAY,CAACA,OAAO,CAACqD,GAAzB,EAA8B;AAC1BC,MAAAA,IAAI,CAAC5G,IAAL,CAAU,4BAAV;AACH;;AACD,QAAI,CAACsD,OAAD,IAAY,CAACA,OAAO,CAACE,OAAzB,EAAkC;AAC9BoD,MAAAA,IAAI,CAAC5G,IAAL,CAAU,gCAAV;AACH;;AACD,QAAI6G,QAAQ,GAAG/F,MAAM,CAACkB,MAAP,CAAcmE,UAAd,EAA0B7C,OAA1B,CAAf;;AACAoD,IAAAA,EAAE,CAACI,QAAH,GAAcD,QAAd;AACAH,IAAAA,EAAE,CAACK,KAAH,GAAW9B,OAAO,CAAC+B,WAAR,CAAoBH,QAAQ,CAACrD,OAA7B,CAAX,CAViC;;AAYjCkD,IAAAA,EAAE,CAACO,WAAH,GAAiB,EAAjB,CAZiC;;AAajCP,IAAAA,EAAE,CAACQ,YAAH,GAAkB,EAAlB,CAbiC;;AAcjCR,IAAAA,EAAE,CAACS,MAAH,GAAY,EAAZ,CAdiC;;AAejCT,IAAAA,EAAE,CAACU,eAAH,CAAmBP,QAAnB;AACAH,IAAAA,EAAE,CAACW,QAAH,CAAYR,QAAZ;AACH,GAjBD;AAkBA;AACJ;AACA;AACA;;;AACIL,EAAAA,SAAS,CAACa,QAAV,GAAqB,UAAU/D,OAAV,EAAmB;AACpC,QAAMoD,EAAE,GAAG,IAAX,CADoC;;AAGpC,QAAIb,eAAa,GAAGyB,aAApB;AACAzB,IAAAA,eAAa,CAAChD,OAAd,CAAsB,UAAA2C,MAAM,EAAI;AAC5B,UAAI+B,YAAY,GAAGjC,EAAE,CAACE,MAAD,CAArB;AACA1E,MAAAA,MAAM,CAAC0G,cAAP,CAAsBlC,EAAtB,EAA0BE,MAA1B,EAAkC;AAC9BiC,QAAAA,QAAQ,EAAE,IADoB;AAE9BC,QAAAA,UAAU,EAAE,IAFkB;AAG9BC,QAAAA,YAAY,EAAE,IAHgB;AAI9BzJ,QAAAA,KAAK,EAAE,eAAUoF,OAAV,EAAmB;AACtB,cAAIsE,KAAJ;;AACA,cAAIpC,MAAM,KAAKK,eAAa,CAACgC,YAA7B,EAA2C;AACvCD,YAAAA,KAAK,GAAGhB,IAAI,CAAC3D,wBAAL,CAA8BK,OAAO,CAACJ,KAAtC,CAAR;AACH,WAFD,MAEO;AACH0E,YAAAA,KAAK,GAAGtE,OAAO,CAACb,GAAhB;AACH;;AACD,cAAI;AACA,gBAAI0C,IAAI,GAAG;AACP2C,cAAAA,SAAS,EAAEF,KADJ;AAEPG,cAAAA,QAAQ,EAAErB,EAAE,CAACQ,YAAH,IAAmB;AAFtB,aAAX;AAIAR,YAAAA,EAAE,CAACsB,OAAH,CAAW,SAAX,EAAsB7C,IAAtB;AACAuB,YAAAA,EAAE,CAACQ,YAAH,GAAkBU,KAAlB;AACH,WAPD,CAOE,OAAO1H,CAAP,EAAU;AACR0G,YAAAA,IAAI,CAAC5G,IAAL,CAAU,0BAAV;AACH;;AACD,iBAAOuH,YAAY,CAACnJ,IAAb,CAAkB,IAAlB,EAAwBkF,OAAxB,CAAP;AACH;AAtB6B,OAAlC;AAwBH,KA1BD,EAJoC;;AAgCpC,QAAIwC,eAAa,GAAGwB,aAApB;AACAxB,IAAAA,eAAa,CAACjD,OAAd,CAAsB,UAAAoF,IAAI,EAAI;AAC1B,UAAIC,aAAa,GAAG5C,EAAE,CAAC2C,IAAD,CAAtB;AACAnH,MAAAA,MAAM,CAAC0G,cAAP,CAAsBlC,EAAtB,EAA0B2C,IAA1B,EAAgC;AAC5BR,QAAAA,QAAQ,EAAE,IADkB;AAE5BC,QAAAA,UAAU,EAAE,IAFgB;AAG5BC,QAAAA,YAAY,EAAE,IAHc;AAI5BzJ,QAAAA,KAAK,EAAE,iBAAY;AACf,cAAIiK,IAAI,GAAG,EAAX;AACA,cAAIC,SAAS,GAAG,IAAIhJ,IAAJ,GAAWC,OAAX,EAAhB;;AACA,eAAK,IAAIgJ,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAG1H,SAAS,CAACC,MAAhC,EAAwCyH,EAAE,EAA1C,EAA8C;AAC1CF,YAAAA,IAAI,CAACE,EAAD,CAAJ,GAAW1H,SAAS,CAAC0H,EAAD,CAApB;AACH;;AACD,cAAIC,SAAS,GAAGH,IAAI,CAAC,CAAD,CAApB;AACA,cAAI1F,GAAG,GAAG6F,SAAS,CAAC7F,GAAV,IAAiB,EAA3B;AAEA,cAAI8F,OAAJ;;AACA,cAAIN,IAAI,KAAK,SAAb,EAAwB;AACpBM,YAAAA,OAAO,GAAGD,SAAS,CAACnD,IAApB;AACH;;AACD,cAAIqD,cAAc,GAAG,SAAjBA,cAAiB,CAAU7C,GAAV,EAAe;AAChC,gBAAI;AACA;AACA,kBAAI,CAAC,CAACA,GAAF,IAASA,GAAG,CAAC8C,UAAb,IAA2B9C,GAAG,CAAC8C,UAAJ,IAAkB,GAAjD,EAAsD;AAClD,oBAAItD,IAAI,GAAG;AACP2C,kBAAAA,SAAS,EAAElB,IAAI,CAACvE,OAAL,EADJ;AAEPqG,kBAAAA,OAAO,EAAEJ,SAAS,CAAC7F,GAAV,IAAiB,EAFnB;AAGPkG,kBAAAA,cAAc,EAAErB,UAHT;AAIPsB,kBAAAA,YAAY,EAAEnE,IAAI,CAACE,SAAL,CAAegB,GAAf,CAJP;AAKPkD,kBAAAA,UAAU,EAAElD,GAAG,CAAC8C;AALT,iBAAX;;AAOA,oBAAIhG,GAAG,IAAIA,GAAG,CAACM,OAAJ,CAAY2D,EAAE,CAAClD,OAAf,KAA2B,CAAC,CAAvC,EAA0C;AACtCkD,kBAAAA,EAAE,CAACsB,OAAH,CAAW,UAAX,EAAuB7C,IAAvB;AACH;AACJ,eAXD,MAWO;AACH,oBAAI2D,OAAO,GAAG,IAAI1J,IAAJ,GAAWC,OAAX,EAAd;AACA,oBAAI0J,WAAW,GAAG;AACdjB,kBAAAA,SAAS,EAAElB,IAAI,CAACvE,OAAL,EADG;AAEd2G,kBAAAA,QAAQ,EAAEF,OAAO,GAAGV,SAFN;AAGdM,kBAAAA,OAAO,EAAEJ,SAAS,CAAC7F,GAAV,IAAiB,EAHZ;AAIdkG,kBAAAA,cAAc,EAAErB,YAJF;AAKdsB,kBAAAA,YAAY,EAAEnE,IAAI,CAACE,SAAL,CAAegB,GAAf,CALA;AAMdkD,kBAAAA,UAAU,EAAElD,GAAG,CAAC8C,UAAJ,IAAkB;AANhB,iBAAlB;;AAQA,oBAAIhG,GAAG,IAAIA,GAAG,CAACM,OAAJ,CAAY2D,EAAE,CAAClD,OAAf,KAA2B,CAAC,CAAvC,EAA0C;AACtCkD,kBAAAA,EAAE,CAACsB,OAAH,CAAW,UAAX,EAAuBe,WAAvB;AACH;AACJ;AACJ,aA3BD,CA2BE,OAAO7I,CAAP,EAAU;AACR0G,cAAAA,IAAI,CAAC5G,IAAL,CAAU,2BAAV;AACH;;AACD,gBAAI,OAAOsI,SAAS,CAACW,OAAjB,KAA6B,UAAjC,EAA6C;AACzC,qBAAOX,SAAS,CAACW,OAAV,CAAkBtD,GAAlB,CAAP;AACH;AACJ,WAlCD;;AAmCA,cAAIuD,WAAW,GAAG,SAAdA,WAAc,CAAUlE,GAAV,EAAe;AAC7B,gBAAI;AACA,kBAAIG,IAAI,GAAG;AACP2C,gBAAAA,SAAS,EAAElB,IAAI,CAACvE,OAAL,EADJ;AAEPqG,gBAAAA,OAAO,EAAEJ,SAAS,CAAC7F,GAAV,IAAiB,EAFnB;AAGPkG,gBAAAA,cAAc,EAAErB,UAHT;AAIPsB,gBAAAA,YAAY,EAAEnE,IAAI,CAACE,SAAL,CAAeK,GAAf,CAJP;AAKP6D,gBAAAA,UAAU,EAAE;AALL,eAAX;;AAOA,kBAAIpG,GAAG,IAAIA,GAAG,CAACM,OAAJ,CAAY2D,EAAE,CAAClD,OAAf,KAA2B,CAAC,CAAvC,EAA0C;AACtCkD,gBAAAA,EAAE,CAACsB,OAAH,CAAW,UAAX,EAAuB7C,IAAvB;AACH;AACJ,aAXD,CAWE,OAAOjF,CAAP,EAAU;AACR0G,cAAAA,IAAI,CAAC5G,IAAL,CAAU,2BAAV;AACH;;AACD,gBAAI,OAAOsI,SAAS,CAAC5C,IAAjB,KAA0B,UAA9B,EAA0C;AACtC,qBAAO4C,SAAS,CAAC5C,IAAV,CAAeV,GAAf,CAAP;AACH;AACJ,WAlBD;;AAmBA,cAAImE,UAAU,GAAGvC,IAAI,CAAC7E,QAAL,CAAc6E,IAAI,CAAC7E,QAAL,CAAc,EAAd,EAAkBuG,SAAlB,CAAd,EAA4C;AAAEW,YAAAA,OAAO,EAAET,cAAX;AAA2B9C,YAAAA,IAAI,EAAEwD;AAAjC,WAA5C,CAAjB;;AACA,iBAAOhB,aAAa,CAAC9J,IAAd,CAAmB,IAAnB,EAAyB+K,UAAzB,CAAP;AACH;AAzE2B,OAAhC;AA2EH,KA7ED;AA8EH,GA/GD;AAgHA;AACJ;AACA;AACA;AACA;;;AACI3C,EAAAA,SAAS,CAACwB,OAAV,GAAoB,UAAU/J,IAAV,EAAgBkH,IAAhB,EAAsB;AACtC,QAAIiE,OAAJ;AAAA,QACIC,OAAO,GAAG5E,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeQ,IAAf,CAAX,CADd;AAAA,QAEIuB,EAAE,GAAG,IAFT;;AAGA,QAAI,CAACA,EAAE,CAACO,WAAR,EAAqB;AACjBP,MAAAA,EAAE,CAACU,eAAH,CAAmBV,EAAE,CAACpD,OAAtB;AACAe,MAAAA,UAAU,CAAC,YAAM;AACb2D,QAAAA,OAAO,CAAC/J,IAAD,EAAOkH,IAAP,CAAP;AACH,OAFS,EAEP,GAFO,CAAV;AAGA;AACH;;AACD,YAAQlH,IAAR;AACI,WAAK,SAAL;AACImL,QAAAA,OAAO,GAAGtI,MAAM,CAACkB,MAAP,CAAcqH,OAAd,EAAuB3C,EAAE,CAACO,WAA1B,CAAV;AACAmC,QAAAA,OAAO,CAACjC,MAAR,GAAiBT,EAAE,CAACS,MAAH,IAAa,EAA9B;AACIiC,QAAAA,OAAO,CAACE,UAAR,GAAqBrL,IADzB;AAEAmL,QAAAA,OAAO,CAACG,UAAR,GAAqB3C,IAAI,CAAC3F,UAAL,CAAgB,IAAI7B,IAAJ,EAAhB,EAA4B,qBAA5B,CAArB;AACAsH,QAAAA,EAAE,CAACK,KAAH,CAASyC,WAAT,CAAqBJ,OAArB;AACA;;AACJ,WAAK,UAAL;AACIA,QAAAA,OAAO,GAAGtI,MAAM,CAACkB,MAAP,CAAcqH,OAAd,EAAuB3C,EAAE,CAACO,WAA1B,CAAV;AACAmC,QAAAA,OAAO,CAACjC,MAAR,GAAiBT,EAAE,CAACS,MAAH,IAAa,EAA9B;AACIiC,QAAAA,OAAO,CAACE,UAAR,GAAqBrL,IADzB;AAEAmL,QAAAA,OAAO,CAACG,UAAR,GAAqB3C,IAAI,CAAC3F,UAAL,CAAgB,IAAI7B,IAAJ,EAAhB,EAA4B,qBAA5B,CAArB;AACAsH,QAAAA,EAAE,CAACK,KAAH,CAASyC,WAAT,CAAqBJ,OAArB;AACA;;AACJ,WAAK,UAAL;AACIA,QAAAA,OAAO,GAAGtI,MAAM,CAACkB,MAAP,CAAcqH,OAAd,EAAuB3C,EAAE,CAACO,WAA1B,CAAV;AACAmC,QAAAA,OAAO,CAACjC,MAAR,GAAiBT,EAAE,CAACS,MAAH,IAAa,EAA9B;AACIiC,QAAAA,OAAO,CAACE,UAAR,GAAqBrL,IADzB;AAEAmL,QAAAA,OAAO,CAACG,UAAR,GAAqB3C,IAAI,CAAC3F,UAAL,CAAgB,IAAI7B,IAAJ,EAAhB,EAA4B,qBAA5B,CAArB;AACAsH,QAAAA,EAAE,CAACK,KAAH,CAASyC,WAAT,CAAqBJ,OAArB;AACA;AArBR;AAyBH,GApCD;AAsCA;AACJ;AACA;AACA;;;AACI5C,EAAAA,SAAS,CAACY,eAAV,GAA4B,UAAUqC,MAAV,EAAkB;AAC1C,QAAI/C,EAAE,GAAG,IAAT,CAD0C;;AAG1CpB,IAAAA,EAAE,CAACoE,aAAH,CAAiB;AACbT,MAAAA,OAAO,EAAE,iBAACtD,GAAD,EAAS;AACde,QAAAA,EAAE,CAACO,WAAH,GAAiB;AACbN,UAAAA,GAAG,EAAE8C,MAAM,CAAC9C,GAAP,IAAc,EADN;AAEb1I,UAAAA,IAAI,EAAEqJ,OAFO;AAES;AACtBqC,UAAAA,cAAc,EAAEF,MAAM,CAACE,cAAP,IAAyBrC,kBAH5B;AAGuD;AACpEsC,UAAAA,WAAW,EAAEhD,IAAI,CAAC3H,YAAL,EAJA;AAIqB;AAClC4K,UAAAA,EAAE,EAAElE,GAAG,CAACmE,MAAJ,CAAW/G,OAAX,CAAmB,KAAnB,MAA8B,CAAC,CAA/B,GAAmC,SAAnC,GAA+C,KALtC;AAK6C;AAC1DgH,UAAAA,UAAU,EAAEpE,GAAG,CAACqE,KANH;AAMU;AACvBC,UAAAA,KAAK,EAAEtE,GAAG,CAACsE,KAPE;AAOK;AAClBC,UAAAA,cAAc,EAAEvE,GAAG,CAACwE,OARP;;AAAA,SAAjB;AAUH;AAZY,KAAjB;AAcH,GAjBD;AAkBA;AACJ;AACA;AACA;;;AACI3D,EAAAA,SAAS,CAAC4D,SAAV,GAAsB,UAAUjD,MAAV,EAAkB;AACpC,SAAKA,MAAL,GAAcA,MAAd;AACH,GAFD;AAGA;AACJ;AACA;AACA;;;AACIX,EAAAA,SAAS,CAAC6D,OAAV,GAAoB,UAAUZ,MAAV,EAAkB;AAClC,QAAI/C,EAAE,GAAG,IAAT;AAAA,QACI4D,UAAU,GAAG;AACTC,MAAAA,OAAO,EAAE,iBAAUrK,CAAV,EAAa;AAClB,YAAIC,CAAC,GAAG,MAAMQ,SAAS,CAACC,MAAhB,GAAyB,CAACD,SAAS,CAAC,CAAD,CAAV,CAAzB,GAA0C6J,KAAK,CAACpI,KAAN,CAAY,IAAZ,EAAkBzB,SAAlB,CAAlD;AAAA,YACInB,CAAC,GAAGiK,MAAM,CAACc,OADf;;AAEA,YAAI;AACA,cAAIpF,IAAI,GAAG;AACP2C,YAAAA,SAAS,EAAElB,IAAI,CAACvE,OAAL,EADJ;AAEPoI,YAAAA,YAAY,EAAEC,MAAM,CAACxK,CAAD;AAFb,WAAX;AAIAwG,UAAAA,EAAE,CAACsB,OAAH,CAAW,UAAX,EAAuB7C,IAAvB;AACH,SAND,CAME,OAAOH,GAAP,EAAY;AACV4B,UAAAA,IAAI,CAAC5G,IAAL,CAAU,yCAAV,EAAqDgF,GAArD;AACH;;AACD,YAAI,cAAc,OAAOxF,CAAzB,EAA4B;AACxB,iBAAOA,CAAC,CAAC4C,KAAF,CAAQ,IAAR,EAAcjC,CAAd,CAAP;AACH;AACJ;AAhBQ,KADjB;AAmBA,WAAOyG,IAAI,CAAClG,GAAL,CAAS,EAAT,EAAa+I,MAAb,EAAqBa,UAArB,CAAP;AAEH,GAtBD;AAuBH;;AC3PD,IAAI9D,SAAS,GAAG,EAAhB;;AAEAA,SAAS,CAACmE,IAAV,GAAiB,UAASrH,OAAT,EAAkB;AAC/B,OAAKmD,KAAL,CAAWnD,OAAX;AACH,CAFD;;AAIAiD,SAAS,CAACC,SAAD,CAAT;;ACNA;AACA;AACA;;AACA,YAAe;AACXA,EAAAA,SAAS,EAATA;AADW,CAAf;;;;"}